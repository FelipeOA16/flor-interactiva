<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üå∏Flores para Mariluzüå∏</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <main class="wrap">
    <section class="card" aria-label="Tarjeta de flor">

      <!-- RAMO -->
      <div class="bouquet" aria-hidden="true">
        <div class="wrapPaper"></div>

        <div class="bloom b1">
          <span class="petal p1"></span><span class="petal p2"></span><span class="petal p3"></span>
          <span class="petal p4"></span><span class="petal p5"></span><span class="petal p6"></span>
          <span class="center"></span>
        </div>

        <div class="bloom b2">
          <span class="petal p1"></span><span class="petal p2"></span><span class="petal p3"></span>
          <span class="petal p4"></span><span class="petal p5"></span><span class="petal p6"></span>
          <span class="center"></span>
        </div>

        <div class="bloom b3">
          <span class="petal p1"></span><span class="petal p2"></span><span class="petal p3"></span>
          <span class="petal p4"></span><span class="petal p5"></span><span class="petal p6"></span>
          <span class="center"></span>
        </div>

        <div class="bloom b4">
          <span class="petal p1"></span><span class="petal p2"></span><span class="petal p3"></span>
          <span class="petal p4"></span><span class="petal p5"></span><span class="petal p6"></span>
          <span class="center"></span>
        </div>

        <div class="bloom b5">
          <span class="petal p1"></span><span class="petal p2"></span><span class="petal p3"></span>
          <span class="petal p4"></span><span class="petal p5"></span><span class="petal p6"></span>
          <span class="center"></span>
        </div>

        <div class="stem s1"></div>
        <div class="stem s2"></div>
        <div class="stem s3"></div>

        <div class="leaf l1"></div>
        <div class="leaf l2"></div>
        <div class="leaf l3"></div>

        <!-- LAZO (dentro del ramo) -->
        <div class="bow" aria-hidden="true">
          <span class="loop left"></span>
          <span class="loop right"></span>
          <span class="knot"></span>
        </div>
      </div>

      <h1 class="title">Para ti</h1>

      <p id="msg" class="msg" aria-live="polite"></p>

      <button id="revealBtn" class="btn" type="button">
        Ver algo ‚ú®
      </button>

      <div id="reveal" class="reveal" hidden>
        <p class="revealText">Si alg√∫n d√≠a te puedo dar flores en persona, lo har√©.</p>
      </div>

      <p class="footer">‚Äî enviado desde un lugar donde s√≠ llega el cari√±o</p>

      <!-- Contenedor para explosi√≥n (posicionado absoluto dentro de la card) -->
      <div id="burst" class="burst" aria-hidden="true"></div>

    </section>
  </main>

  <script>
    // ===== 1) Mensaje typewriter =====
    const text = [
      "Hoy me acord√© de ti.",
      "Quer√≠a enviarte flores, pero la distancia no ayuda‚Ä¶",
      "as√≠ que te mando una versi√≥n que s√≠ llega."
    ].join("\n");

    const el = document.getElementById("msg");
    let i = 0;

    function type() {
      if (i <= text.length) {
        el.textContent = text.slice(0, i);
        i++;
        setTimeout(type, 22);
      }
    }
    type();

    // ===== 2) Reveal + Explosi√≥n siempre =====
    const btn = document.getElementById("revealBtn");
    const reveal = document.getElementById("reveal");
    const burst = document.getElementById("burst");

    function placeBurstAtButton() {
      // Posiciona el origen de la explosi√≥n en el centro del bot√≥n
      const cardRect = document.querySelector(".card").getBoundingClientRect();
      const btnRect = btn.getBoundingClientRect();

      const x = (btnRect.left + btnRect.width / 2) - cardRect.left;
      const y = (btnRect.top + btnRect.height / 2) - cardRect.top;

      burst.style.left = `${x}px`;
      burst.style.top = `${y}px`;
    }

    function flowerBurst() {
      // Limpia part√≠culas anteriores (para clicks infinitos)
      burst.innerHTML = "";

      const count = 40; // m√°s cantidad, se siente mejor
      for (let i = 0; i < count; i++) {
        const p = document.createElement("span");
        p.className = "flowerParticle";

        // dispersi√≥n circular con random
        const angle = (Math.PI * 2 * i) / count + (Math.random() * 0.35);
        const radius = 110 + Math.random() * 120;

        const dx = Math.cos(angle) * radius;
        const dy = Math.sin(angle) * radius;

        p.style.setProperty("--dx", `${dx}px`);
        p.style.setProperty("--dy", `${dy}px`);
        p.style.setProperty("--rot", `${(Math.random() * 720 - 360).toFixed(0)}deg`);

        const duration = 650 + Math.random() * 650;
        p.style.animation = `fly ${duration}ms ease-out forwards`;

        const hueShift = Math.floor(Math.random() * 22) - 11;
        p.style.filter = `hue-rotate(${hueShift}deg) drop-shadow(0 12px 12px rgba(255,127,176,.20))`;

        burst.appendChild(p);
        setTimeout(() => p.remove(), duration + 50);
      }
    }

    btn.addEventListener("click", () => {
      // Mostrar mensaje la primera vez
      if (reveal.hidden) reveal.hidden = false;

      // Reiniciar animaci√≥n pop para que se vea cada vez
      reveal.classList.remove("pop");
      void reveal.offsetWidth; // reflow
      reveal.classList.add("pop");

      // Explosi√≥n desde el bot√≥n
      placeBurstAtButton();
      flowerBurst();

      // Cambia texto del bot√≥n (sin deshabilitar)
      btn.textContent = "Otra vez ‚ú®";
    });

    // Si cambias el tama√±o de la ventana, la explosi√≥n sigue saliendo bien
    window.addEventListener("resize", () => {
      // nada, porque siempre se recalcula al click
    });
  </script>
</body>
</html>
